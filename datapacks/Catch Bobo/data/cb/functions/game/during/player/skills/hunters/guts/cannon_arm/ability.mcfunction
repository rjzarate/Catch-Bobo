execute if data entity @s SelectedItem.tag.cannonArm unless data entity @s SelectedItem.tag.ChargedProjectiles[0] unless score @s cannonArm matches ..0 run scoreboard players remove @s cannonArm 1
execute if entity @s[nbt={Inventory:[{Slot:-106b,tag:{cannonArm:1,Charged:0b}}]}] unless score @s cannonArm matches ..0 run scoreboard players remove @s cannonArm 1

execute if data entity @s SelectedItem.tag.cannonArm unless data entity @s SelectedItem.tag.ChargedProjectiles[0] unless score @s cannonArm matches ..0 run item replace entity @s weapon.mainhand with crossbow{display:{Name:'{"text":"Cannon Arm","color":"dark_red","bold":true,"italic":false}',Lore:['{"text":"A rocket that deals X damage.","color":"gray"}','{"text":"90s CD"}']},HideFlags:37,Unbreakable:1b,Enchantments:[{id:"minecraft:quick_charge",lvl:6s}],ChargedProjectiles:[{id:"minecraft:firework_rocket",Count:1b,tag:{Fireworks:{Explosions:[{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]}]}}},{},{}],Charged:1b,cannonArm:1,noDrop:1} 1
execute if entity @s[nbt={Inventory:[{Slot:-106b,tag:{cannonArm:1,Charged:0b}}]}] unless score @s cannonArm matches ..0 run item replace entity @s weapon.offhand with crossbow{display:{Name:'{"text":"Cannon Arm","color":"dark_red","bold":true,"italic":false}',Lore:['{"text":"A rocket that deals X damage.","color":"gray"}','{"text":"90s CD"}']},HideFlags:37,Unbreakable:1b,Enchantments:[{id:"minecraft:quick_charge",lvl:6s}],ChargedProjectiles:[{id:"minecraft:firework_rocket",Count:1b,tag:{Fireworks:{Explosions:[{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]},{Type:0,Colors:[I;0]}]}}},{},{}],Charged:1b,cannonArm:1,noDrop:1} 1

